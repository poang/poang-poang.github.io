# Set集合

## HashSet 集合介绍

`java.util.Set`接口和`java.util.List`接口一样，同样继承自`Collection`接口，它与`Collection`接口中的方法基本一致，并没有对`Collection`接口进行功能上的扩充，只是比`Collection`接口更加严格了。与`List`接口不同的是，`Set`接口中元素无序，并且都会以某种规则保证存入的元素不出现重复。

`Set`集合有多个子类，这里我们介绍其中的`java.util.HashSet`、`java.util.LinkedHashSet`这两个集合。

`java.util.HashSet`是`Set`接口的一个实现类，它所存储的元素是不可重复的，并且元素都是无序的(即存取顺序不一致)。`java.util.HashSet`底层的实现其实是一个`java.util.HashMap`支持。

`HashSet`是根据对象的哈希值来确定元素在集合中的存储位置，因此具有良好的存取和查找性能。保证元素唯一性的方式依赖于：`hashCode`与`equals`方法。

Set集合代码示例：

```java
public class HashSetTest {
     public static void main(String[] args) {
         HashSet<String> set = new HashSet<String>();
         set.add(new String("acb"));
         set.add("abc");
         set.add("cab");
         set.add("acb");
         for (String name : set) {
             System.out.println(name);
        }
     }
}
```

输出结果如下，说明集合中不能存储重复元素：

```java
acb
abc
cab
```

## HashSet集合存储数据的结构（哈希表）

在jdk1.8版本之前，哈希表=[数组](https://so.csdn.net/so/search?q=数组&spm=1001.2101.3001.7020)+链表结构
在jdk1.8版本之后，值得注意的是。哈希表也=数组+[链表](https://so.csdn.net/so/search?q=链表&spm=1001.2101.3001.7020)，但是呢哈希表还=数组+红黑树（提高查询的速度）

哈希表是由数组+链表+红黑树(JDK1.8增加了红黑树)实现的，如下图所示。

<img src="https://poangspic.oss-cn-beijing.aliyuncs.com/img/image-20220307150126468.png" alt="image-20220307150126468" style="zoom:80%;" />

存储流程图：

<img src="https://poangspic.oss-cn-beijing.aliyuncs.com/img/image-20220307150200374.png" alt="image-20220307150200374" style="zoom: 80%;" />

**JDK1.8**引入红黑树大程度优化了HashMap的性能，那么对于我们来讲保证HashSet集合元素的唯一，其实就是根据对象的hashCode和equals方法来决定的。如果我们往集合中存放自定义的对象，那么保证其唯一，就必须复写hashCode和equals方法建立属于当前对象的比较方式。

## HashSet存储自定义类型元素

给HashSet中存放自定义类型元素时，需要重写对象中的hashCode和equals方法，建立自己的比较方式，才能保证HashSet集合中的对象唯一。

```java
public class StundentTest {
    public static void main(String[] args) {
        HashSet<Student> stuSet = new HashSet<>();
        Student stu = new Student("老王",22);
        stuSet.add(stu);
        stuSet.add(new Student("老李",44));
        stuSet.add(new Student("老王",22));
        stuSet.add(new Student("老余",20));
        for (Student stu1 : stuSet){
            System.out.println(stu1);
        }
    }
}

public class Student {
    private String name;
    private int age;

    public Student() {
    }

    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }


    @Override
    public String toString() {
        return "Student{" +
                "name='" + name + '\'' +
                ", age=" + age +
                '}';
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Student)) return false;

        Student student = (Student) o;

        if (age != student.age) return false;
        return name != null ? name.equals(student.name) : student.name == null;
    }

    @Override
    public int hashCode() {
        int result = name != null ? name.hashCode() : 0;
        result = 31 * result + age;
        return result;
    }
}
```

执行结果：

```java
Student{name='老王', age=22}
Student{name='老李', age=44}
Student{name='老余', age=20}
```

